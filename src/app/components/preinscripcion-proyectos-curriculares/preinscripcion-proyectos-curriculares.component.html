<div [class.loader-div]="loading">
    <mat-spinner *ngIf="loading" diameter="100" color="primary"></mat-spinner>
</div>
<mat-card class="mt-20">

    <mat-card-header class="mt-20 center-header">
        <mat-card-title>
            {{"preinscripcion-proyectos-curriculares.titulo" | translate}}
        </mat-card-title>
    </mat-card-header>

    <mat-card-content class=" mt-20 form-grid3 ">

        <mat-form-field class="form-item">
            <mat-label>
                {{"preinscripcion-proyectos-curriculares.primer_nombre" | translate}}:
            </mat-label>
            <input type="text" matInput [formControl]="primerNombre" [value]="primerNombre.value" [disabled]="true">
            <mat-error *ngIf="segundoNombre.hasError('required')">{{ 'admision.erro_selec_nivel' | translate
                }}</mat-error>
        </mat-form-field>

        <mat-form-field class="form-item">
            <mat-label>
                {{"preinscripcion-proyectos-curriculares.segundo_nombre" | translate}}:
            </mat-label>
            <input type="text" matInput [formControl]="segundoNombre">
            <mat-error *ngIf="segundoNombre.hasError('required')">{{ 'admision.erro_selec_nivel' | translate
                }}</mat-error>
        </mat-form-field>

        <mat-form-field class="form-item">
            <mat-label>
                {{"preinscripcion-proyectos-curriculares.primer_apellido" | translate}}:
            </mat-label>
            <input type="text" matInput [formControl]="primerApellido">
            <mat-error *ngIf="segundoNombre.hasError('required')">{{ 'admision.erro_selec_nivel' | translate
                }}</mat-error>
        </mat-form-field>

        <mat-form-field class="form-item">
            <mat-label>
                {{"preinscripcion-proyectos-curriculares.segundo_apellido" | translate}}:
            </mat-label>
            <input type="text" matInput [formControl]="segundoApellido">
            <mat-error *ngIf="segundoNombre.hasError('required')">{{ 'admision.erro_selec_nivel' | translate
                }}</mat-error>
        </mat-form-field>

        <mat-form-field class="form-item">
            <mat-label>
                {{"preinscripcion-proyectos-curriculares.tipo_documento" | translate}}:
            </mat-label>
            <mat-select [formControl]="tipoDocumento" [(ngModel)]="selectTipoDocumento"
                (selectionChange)="CambioTipoDocumentoChange()">
                <mat-option *ngFor="let item of tipos_documento " [value]="item.TipoDocumentoId.Id">{{
                    item.TipoDocumentoId.Nombre }}</mat-option>
            </mat-select>
            <mat-error *ngIf="segundoNombre.hasError('required')">{{ 'admision.erro_selec_nivel' | translate
                }}</mat-error>
        </mat-form-field>

        <mat-form-field class="form-item">
            <mat-label>
                {{"preinscripcion-proyectos-curriculares.numero_documento" | translate}}:
            </mat-label>
            <input type="number" matInput [formControl]="numeroDocumento" [value]="numeroDocumentoValue">
            <mat-error *ngIf="segundoNombre.hasError('required')">{{ 'admision.erro_selec_nivel' | translate
                }}</mat-error>
        </mat-form-field>

        <mat-form-field class="form-item">
            <mat-label>
                {{"preinscripcion-proyectos-curriculares.fecha_expedicion" | translate}}:
            </mat-label>
            <input type="datetime" matInput [formControl]="fechaExpedicion">
            <mat-error *ngIf="segundoNombre.hasError('required')">{{ 'admision.erro_selec_nivel' | translate
                }}</mat-error>
        </mat-form-field>

        <mat-form-field class="form-item">
            <mat-label>
                {{"preinscripcion-proyectos-curriculares.fecha_nacimiento" | translate}}:
            </mat-label>
            <input type="datetime" matInput [formControl]="fechaNacimiento">
            <mat-error *ngIf="segundoNombre.hasError('required')">{{ 'admision.erro_selec_nivel' | translate
                }}</mat-error>
        </mat-form-field>

        <mat-form-field class="form-item">
            <mat-label>
                {{"preinscripcion-proyectos-curriculares.sexo" | translate}}:
            </mat-label>
            <input matInput [formControl]="sexo">
            <mat-error *ngIf="segundoNombre.hasError('required')">{{ 'admision.erro_selec_nivel' | translate
                }}</mat-error>
        </mat-form-field>

        <mat-form-field class="form-item">
            <mat-label>
                {{"preinscripcion-proyectos-curriculares.correo_eletronico" | translate}}:
            </mat-label>
            <input type="email" matInput [formControl]="correoElectronico">
            <mat-error *ngIf="segundoNombre.hasError('required')">{{ 'admision.erro_selec_nivel' | translate
                }}</mat-error>
        </mat-form-field>

        <mat-form-field class="form-item">
            <mat-label>
                {{"preinscripcion-proyectos-curriculares.telefono" | translate}}:
            </mat-label>
            <input type="number" matInput [formControl]="telefono">
            <mat-error *ngIf="segundoNombre.hasError('required')">{{ 'admision.erro_selec_nivel' | translate
                }}</mat-error>
        </mat-form-field>

    </mat-card-content>

</mat-card>


<mat-card class="mt-20" *ngIf="mostrarPreinscripcion">

    <mat-card-header class="mt-20">
        <mat-card-title>
            {{"preinscripcion-proyectos-curriculares.listado_preinscripciones" | translate}}
        </mat-card-title>
    </mat-card-header>

    <mat-card-header class="mt-20" >
        <section class=" info-alert">
            {{ "preinscripcion-proyectos-curriculares.alerta" | translate }}
        </section>
    </mat-card-header>


    <mat-card-content class="mt-20">

        <section>
            {{ "preinscripcion-proyectos-curriculares.pin" | translate }}
        </section>

        <div class="contenedor-tabla">
            <table mat-table [dataSource]="datasourcePreinscipcion" matSort>

                <ng-container matColumnDef="recibo">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> {{"preinscripcion-proyectos-curriculares.recibo" | translate}} </th>
                    <td mat-cell *matCellDef="let row"> {{row.ReciboInscripcion}} </td>
                </ng-container>

                <ng-container matColumnDef="inscripcion">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> {{"preinscripcion-proyectos-curriculares.inscripcion" | translate}} </th>
                    <td mat-cell *matCellDef="let row"> {{row.Id}} </td>
                </ng-container>

                <ng-container matColumnDef="nivel">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> {{"preinscripcion-proyectos-curriculares.nivel" | translate}} </th>
                    <td mat-cell *matCellDef="let row"> {{row.ProyectoAcademico?.NivelFormacionId.Nombre}} </td>
                </ng-container>

                <ng-container matColumnDef="tipo_inscripcion">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> {{"preinscripcion-proyectos-curriculares.tipo_inscripcion" | translate}} </th>
                    <td mat-cell *matCellDef="let row"> {{row.TipoInscripcionId.Nombre}} </td>
                </ng-container>

                <ng-container matColumnDef="estado_inscripcion">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> {{"preinscripcion-proyectos-curriculares.estado_inscripcion" | translate}} </th>
                    <td mat-cell *matCellDef="let row"> {{row.EstadoInscripcionId.Nombre}} </td>
                </ng-container>

                <ng-container matColumnDef="activo">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> {{ "calendario.estado" | translate }} </th>
                    <td mat-cell *matCellDef="let row">
                      <div class="status-indicator" [ngClass]="{active: row.Activo, inactive: !row.Activo}">
                        <div *ngIf="row.Activo">
                          {{ "GLOBAL.activo" | translate }}
                        </div>
                        <div *ngIf="!row.Activo">
                          {{ "GLOBAL.inactivo" | translate }}
                        </div>
                      </div>
                    </td>
                </ng-container>

                <ng-container matColumnDef="fecha_generacion">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> {{"preinscripcion-proyectos-curriculares.fecha_generacion" | translate}} </th>
                    <td mat-cell *matCellDef="let row"> {{row.FechaCreacion}} </td>
                </ng-container>

                <ng-container matColumnDef="resultado" stickyEnd>
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> {{"GLOBAL.acciones" | translate}} </th>
                    <td mat-cell *matCellDef="let row">
                        <div class="contenedor-acciones">
                            <button mat-icon-button [matMenuTriggerFor]="menu" class="boton-acciones" aria-label="Example icon-button with a menu">
                                <mat-icon>more_vert</mat-icon>
                            </button>
                            <mat-menu #menu="matMenu">
                                <button mat-menu-item (click)="informacionDetalladaPreinscripciones(row.Id)">
                                    <mat-icon>search</mat-icon>
                                    <span>{{"GLOBAL.detalle" | translate}}</span>
                                </button>
                                <button *ngIf="esAdmitido(row.EstadoInscripcionId.CodigoAbreviacion)" mat-menu-item (click)="irPantallaLegalizacion(row)">
                                    <mat-icon>send</mat-icon>
                                    <span>{{"GLOBAL.legalizacion" | translate}}</span>
                                </button>
                            </mat-menu>
                        </div>
                    </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumnsPreinscipcion"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumnsPreinscipcion;"></tr>

                <tr class="mat-row" *matNoDataRow>
                    <td class="mat-cell" colspan="7">No data matching the filter</td>
                </tr>
            </table>

            <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]" aria-label="Select page of users"></mat-paginator>
        </div>
    </mat-card-content>

</mat-card>


<mat-card class="mt-20" *ngIf="detallePreinscripcion">

    <mat-card-header class="mt-20">
        <mat-card-title>
            {{"preinscripcion-proyectos-curriculares.informacion_detalle_preinscripcion" | translate}}
        </mat-card-title>
    </mat-card-header>

    <mat-card-content class="mt-20">
        <section>
            <span>
               <strong>{{"preinscripcion-proyectos-curriculares.periodo_inscrito" | translate}}: {{periodo}}</strong>
            </span>
        </section>
        <br>
        <section>
            <span>
               <strong>{{"preinscripcion-proyectos-curriculares.nivel" | translate}}: {{nivel}}</strong>
            </span>
        </section>
        <br>
        <section>
            <span>
               <strong>{{"preinscripcion-proyectos-curriculares.tipo_inscripcion" | translate}}: {{tipoInscripcion}}</strong>
            </span>
        </section>
        <br>

        <table mat-table [dataSource]="datasourceDetallePreinscipcion" class=" mt-20 mat-elevation-z8">

            <ng-container matColumnDef="credencial">
                <th mat-header-cell *matHeaderCellDef>
                    {{"preinscripcion-proyectos-curriculares.credencial" | translate}} </th>
                <td mat-cell *matCellDef="let element"> {{element.name}} </td>
            </ng-container>

            <ng-container matColumnDef="proyecto">
                <th mat-header-cell *matHeaderCellDef>
                    {{"preinscripcion-proyectos-curriculares.proyecto" | translate}}
                </th>
                <td mat-cell *matCellDef="let element"> {{element.ProyectoAcademico.Nombre}} </td>
            </ng-container>

            <ng-container matColumnDef="puntaje">
                <th mat-header-cell *matHeaderCellDef>
                    {{"preinscripcion-proyectos-curriculares.puntaje" | translate}}
                </th>
                <td mat-cell *matCellDef="let element"> {{element.NotaFinal}} </td>
            </ng-container>

            <ng-container matColumnDef="estado">
                <th mat-header-cell *matHeaderCellDef>
                    {{"preinscripcion-proyectos-curriculares.estado" | translate}}
                </th>
                <td mat-cell *matCellDef="let element"> {{element.EstadoInscripcionId.Nombre}} </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedDetalleColumnsPreinscipcion"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedDetalleColumnsPreinscipcion;"></tr>

        </table>

        <br>
        <br>

        <div class="button-container" style="display: flex; justify-content: center;">
            <div class="button-stepper">
                <button mat-stroked-button (click)="regresar()" class="btn boton-primary">{{ 'listado_pregrado.regresar' | translate
                    }}</button>
            </div>
        </div>

    </mat-card-content>

</mat-card>